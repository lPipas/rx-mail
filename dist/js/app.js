(()=>{let e=document.querySelectorAll(".controls-build img")[0],t=document.querySelectorAll(".controls-sign img:nth-child(3)")[0],n=document.querySelectorAll(".controls-sign img:nth-child(2)")[0],r=document.querySelectorAll(".controls-sign img:nth-child(1)")[0],o=document.querySelectorAll("a img")[0],s=document.querySelectorAll("a img")[1],l=document.querySelectorAll("a img")[2];window.onload=()=>{e.src="dist/img/icons/create.png",t.src="dist/img/icons/send.png",n.src="dist/img/icons/minus.png",r.src="dist/img/icons/plus.png",o.src="dist/img/icons/user&pass.png",s.src="dist/img/icons/dentist.png",l.src="dist/img/icons/server.png",setTimeout((()=>{e.src="dist/img/icons/dark_create.png",t.src="dist/img/icons/dark_send.png",n.src="dist/img/icons/dark_minus.png",r.src="dist/img/icons/dark_plus.png",o.src="dist/img/icons/dark_user&pass.png",s.src="dist/img/icons/dark_dentist.png",l.src="dist/img/icons/dark_server.png"}),1e3)};let c,d,a=document.getElementsByTagName("html")[0],m=document.getElementsByClassName("main")[0],u=document.getElementsByClassName("modal")[0],g=document.getElementById("tabla"),p=document.getElementById("inputCantidad"),y=document.getElementById("pantalla"),E=document.getElementById("crearTabla"),v=document.getElementById("agregarFila"),L=document.getElementById("borrarFila"),b=document.getElementById("obtenerEmails"),h=document.getElementById("check"),k=document.getElementById("cancel"),f=document.querySelector(".modal-user input"),I=document.querySelector(".modal-pass input"),T=1,$=0,B=!0;function H(){""===f.value||""===I.value?alert("Llenar los campos o salir"):(localStorage.setItem("user",f.value),localStorage.setItem("password",I.value),M())}function M(){B=!0,m.style.display="block",u.style.display="none"}function S(){$=0,void 0===T&&(T=1),g.innerHTML=g.innerHTML+`<tr id="fila${T}"><td id="nombre${T}" contenteditable="true"></td><td id="email${T}" contenteditable="true"></td></tr>`,T++,p.value=T}function w(){$=0,void 0===T&&(T=1),T-1!=0&&(g.removeChild(document.getElementById("fila"+(T-1))),T--,p.value=T)}function _(){$<T&&(a.style.cursor="wait",y.innerHTML=y.innerHTML+"Enviando...\n\n",c=document.getElementById(`nombre${$}`),d=document.getElementById(`email${$}`),function(e,t){let n=new Image;n.onerror=()=>{!function(e){y.innerHTML=y.innerHTML+`No encontramos la imagen con el siguiente nombre: ${e}\n\n`,c.style.backgroundColor="#E7DF7C",a.style.cursor="url('dist/img/cursor/default_pointer.png'),auto",$++,_()}(e)},n.src=`http://127.0.0.1:8887/${e}.jpg`,n.crossOrigin="anonymous",n.addEventListener("load",(()=>{let i=document.createElement("canvas"),r=i.getContext("2d");i.width=n.width,i.height=n.height,r.drawImage(n,0,0);let o=i.toDataURL();try{Email.send({Host:"smtp.office365.com",Username:localStorage.getItem("user"),Password:localStorage.getItem("password"),To:t,From:localStorage.getItem("user"),Subject:`RX: ${e} - Consultorio 11 de Abril 130`,Body:"",Attachments:[{name:`${e}.jpg`,data:o}]}).then((function(n){"OK"===n?(y.innerHTML=y.innerHTML+`${n}, enviamos la panoramica de ${e} a el mail: ${t}.\n\n`,c.style.backgroundColor="#7db697",a.style.cursor="url('dist/img/cursor/default_pointer.png'),auto",$++,_()):(y.innerHTML=y.innerHTML+`${n}\n\n`,c.style.backgroundColor="#b66e6e",a.style.cursor="url('dist/img/cursor/default_pointer.png'),auto",$++,_())}))}catch(e){y.innerHTML=y.innerHTML+`${e}\n\n`,a.style.cursor="url('dist/img/cursor/default_pointer.png'),auto"}}))}(c.innerHTML,d.innerHTML))}document.addEventListener("keydown",(function(e){switch(console.log(B),e.key){case"Enter":B?_():H();break;case"Escape":0==B&&M();break;case"+":B&&S();break;case"-":B&&w()}})),o.addEventListener("click",(function(){B=!1,m.style.display="none",u.style.display="flex",f.focus(),f.value="",I.value=""})),h.addEventListener("click",H),k.addEventListener("click",M),E.addEventListener("click",(function(){$=0,T=p.value;let e='<tr><th><img src="dist/img/icons/user_name.png" /></th><th><img src="dist/img/icons/arroba.png" /></th></tr>';for(i=0;i<T;i++)e+=`<tr id="fila${i}"><td id="nombre${i}" contenteditable="true"></td><td id="email${i}" contenteditable="true"></td></tr>`,g.innerHTML=e})),v.addEventListener("click",S),L.addEventListener("click",w),b.addEventListener("click",_)})();